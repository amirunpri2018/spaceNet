{
    "collab_server" : "",
    "contents" : "\\name{spaceNet}\n\\alias{spaceNet}\n\\alias{print.spaceNet}\n\\title{Latent Space Models for Multivariate Networks}\n\n\\description{\nImplements latent space models for multivariate networks (multiplex) via MCMC algorithm.\n}\n\n\\usage{\nmultiNet(Y, niter = 1000, D = 2,\n         muA = 0, tauA = NULL, nuA = 3,\n         muB = 0, tauB = NULL, nuB = 3,\n         muL = 0, tauL = NULL, nuL = 3,\n         alphaRef = 0.1,\n         covariates = NULL,\n         DIC = FALSE,\n         burnIn = round(niter*0.3),\n         trace = TRUE,\n         allChains = FALSE,\n         refSpace = NULL)\n}\n\n\n\\arguments{\n\\item{Y}{A three-dimensional array or list of \\eqn{(n\\times n)}{n x n} adjacency matrices composing the multidimensional network. A list will be converted to an array. If an array, the dimension of \\code{Y} must be \\code{(n,n,K)}, where \\code{n} is the number of nodes and \\code{K} the number of networks. Structural missing values (\\code{NA}) are allowed, but no imputation is performed; see details.}\n\n\\item{niter}{The number of MCMC iterations. The default value is \\code{niter = 1000}.}\n\n\\item{D}{The dimension of the latent space, with \\code{D > 0}. The default value is \\code{D = 2}.}\n\n\\item{muA, muB, muL}{Mean hyperparameters, see details.}\n\n\\item{tauA, tauB, tauL}{Mean hyperparameters, see details.}\n\n\\item{nuA, nuB, nuL}{Variance hyperparameters, see details.}\n\n\\item{alphaRef}{The value for the intercept in the first network (the reference network). This value can be specified by the user pn the basis of prior knowledge or computed using the function \\code{\\link{alphaRef}}, see details.}\n\n\\item{covariates}{An array or a list with edge-covariates matrices. A list is automatically converted to an array. Covariates can be either continuous or discrete and must be constant throughout the views of the multiplex. The dimension of \\code{covariates} is \\code{(n,n,L)}, where \\code{n} is the number of nodes and \\code{L} the number of covariates, that is, the number of covariates matrices. Missing values (\\code{NA}) are not allowed.}\n\n\\item{DIC}{A logical value indicating wether the DIC (Deviance Information Criterion) should be computed (\\code{DIC = TRUE}). The default is \\code{DIC = FALSE}.}\n\n\\item{burnIn}{A numerical value, the number of iterations of the chain to be discarded when computing the posterior estimates. The default value is \\code{burnIn = round(niter*0.3)}.}\n\n\\item{trace}{A logical value indicating if a progress bar should be printed.}\n\n\\item{allChains}{A logical value indicating if the full parameter chains should also be returned in output. The default value is \\code{allChains = FALSE}.}\n\n\\item{refSpace}{Optional. A matrix containing a set of reference values for the latent coordinates of the nodes. Its dimension must be \\code{(n, D)}, where \\code{n} is the number of nodes and \\code{D} the number of dimensions of the latent space. The coordinates stored in the matrix \\code{zTrue} are compared with the estimated ones at each iteration via Procrustes correlation. High values of the correlation index indicate that the estimated coordinates are a translation and/or a rotation of the coordinates in \\code{refSpace}.}\n}\n\n\n\\value{\nAn object of class \\code{'multiNet'} containing the following components:\n\\item{n}{The number of nodes in the multidimensional network.}\n\\item{K}{The number of networks in the multidimensional network.}\n\\item{D}{The number of dimensions of the estimated latent space.}\n\\item{parameters}{A list with the following components:\n\\itemize{\n\\item{\\code{alpha}}{ is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the intercept parameters; }\n\\item{\\code{beta}}{ is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the latent space coefficient parameters;}\n\\item{\\code{lambda}}{ is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the covariate coefficient parameters.}\n}\n}\n\\item{latPos}{A list with posterior estimates of means and standard deviations of the latent coordinates.}\n\\item{accRates}{A list with the following components:\n\\itemize{\n\\item{\\code{alpha}}{ is a vector with the acceptance ratios for the intercept parameters;}\n\\item{\\code{beta}}{ is a vector with the acceptance ratios for the latent space coefficient parameters;}\n\\item{\\code{lambda}}{ is a vector with the acceptance ratios for the covariate coefficient parameters;}\n\\item{\\code{latPos}}{ is a vector with the acceptance ratios for the latent coordinates of the nodes.}\n}\n}\n\\item{DIC}{The Deviance Information Criterion of the estimated model. Computed only if \\code{DIC = TRUE} in input.}\n\\item{allChains}{If \\code{Allchains = TRUE}, a list with the following components is returned:\n\\itemize{\n\\item{\\code{parameters}}{ is a list with the estimated posterior distributions of the model parameters: \\eqn{\\alpha}{\\alpha}, \\eqn{\\beta}{\\beta} and \\eqn{\\lambda}{\\lambda};}\n\\item{\\code{latPos}}{ is an array with the posterior distributions of the latent coordinates of each node;}\n\\item{\\code{priorParameters}}{ is a list with the estimated posterior distributions of the parameters of the prior distributions of \\eqn{\\alpha}{\\alpha}, \\eqn{\\beta}{\\beta} and \\eqn{\\lambda}{\\lambda}. }\n}\n}\n\\item{corrRefSpace}{A numerical vector containing the values of the Procrustes correlation between the reference space and the estimated one, computed at each mcmc iteration. Only outputed when \\code{refSpace} is given, otherwise \\code{NULL}.}\n\\item{info}{A list with some information on the estimated model:\n\\itemize{\n\\item{\\code{call}}{ is the name given to the output of \\code{multiNet};}\n\\item{\\code{niter}}{ is the number of mcmc iterations;}\n\\item{\\code{burnIn}}{ is the number of initial iterations to discard when computing the estimates;}\n\\item{\\code{covariates}}{ is the covariates array, if present;}\n\\item{\\code{L}}{ is the number of covariates.}\n}\n}\n}\n\n\\details{ %%%to do\nThe function estimates a latent space model for multidimensional networks (multiplex). The nodes of the multiplex are assumed to be lying in a low-dimensional latent space. The latent space representation of the nodes serves to explain the observed links in the networks. Indeed, it is assumed that closer nodes in the latent space have an high probability to connect in the m ultiplex, while nodes that are far apart are less likely to be linked. Then, the distances between couples of nodes are of interest. These distances can be considered as overall similarities, the idea being that if two units have a lot in common (they are close in the latent space) they are more likely to connect.\nThis hypothesis is expressed in the formulation of the edge probabilities; the probability of an edge beteween nodes \\eqn{i}{i} and \\eqn{j}{j} in the \\eqn{k^{th}}{k_{th}} network is defined as:\n\n\\deqn{\n P \\Bigl( y_{ij}^{(k)} = 1 | \\Omega^{(k)} , d_{ij}, \\lambda \\Bigr)=\n\\frac{ G_{ij}^{(k)} }{1 +  G_{ij}^{(k)} }.}{\nP ( y_{ijk} = 1 | \\Omega_k , d_{ij} , \\lambda ) =  G_{ijk} \\ ( 1 + G_{ijk} ).}\n\nwith \\eqn{G_{ij}^{(k)} = \\exp{\\alpha^{(k)}-\\beta^{(k)} d_{ij} -\\lambda x_{ij}} }{G_{ijk} = exp( \\alpha_k - \\beta_k * d_{ij} - \\lambda * x_{ij} )}. The arguments of \\eqn{G_{ij}^{(k)}}{G_{ijk}} are:\n\\itemize{\n\\item{}{The squared Euclidean distance between nodes \\eqn{i}{i} and \\eqn{j}{j} in the latent space, \\eqn{d_{ij}}{d_{ij}.}}\n\\item{}{A coefficient \\eqn{\\lambda}{\\lambda} to scale the edge-specific covariate \\eqn{x_{ij}}{x_{ij}}. If more than one covariate is introduced in the model, the sum is considered, with each covariate being rescaled with a specific coefficient \\eqn{\\lambda_l}{\\lambda_l}. Edge-specific covariates are assumed to be inversely related to edge probabilities, hence \\eqn{\\lambda \\geq 0}{ \\lambda => 0 }. Preliminary analysis on the association between the covariates an the data can be performed to test this assumption. Also, models with different reparametrizations of the covariate matrices  can be compared with the Deviance Information Criterion.}\n\\item{}{A vector of network-specific parameters, \\eqn{\\Omega^{(k)} = (\\alpha^{(k)},\\beta^{(k)}) }{\\Omega_k = ( \\alpha_k, \\beta_k )}. These parameters are:\n\\itemize{\n\\item{}{A rescaling coefficient \\eqn{\\beta^{(k)} }{\\beta_k}, that weights the importance of the latent space in the \\eqn{k^{th}}{k_{th}} network, with \\eqn{\\beta^{(k)} \\geq 0 }{\\beta_k => 0}. The intercept in the first network (that is the reference network) is fixed to \\eqn{\\beta^{(1)} = 1}{\\beta_1 = 1} for identifiability reasons.  }\n\\item{}{An intercept parameter \\eqn{\\alpha^{(k)} }{\\alpha_k}, that corresponds to the highest edge probability allowed in the \\eqn{k^{th}}{k_{th}} network. Indeed, when  \\eqn{\\beta^{(k)} = 0 }{\\beta_k = 0} and when no covariate is included, the probability of having a link between a couple of nodes is that of the random graph:\n\\deqn{\n P \\Bigl( y_{ij}^{(k)} = 1 |  \\alpha^{(k)} \\Bigr)=\n\\frac{ \\exp{\\alpha^{(k)}} }{1 +  \\exp{\\alpha^{(k)}} }.}{\nP ( y_{ijk} = 1 | \\alpha_k ) = exp( \\alpha_k ) \\ ( 1 + exp( \\alpha_k ) ).}\n}\nThe intercepts have a lower bound in \\eqn{\\log \\Bigl( \\frac{\\log (n)}{ n - \\log(n)} \\Bigr) }{ log ( log( n ) \\ ( n - log( n )  ) )}. The intercept of the first network has to be fixed. Its value can be either specified by the user on the basis of prior knowledge or computed with the function \\code{\\link{alphaRef}}.\n}\n}\n}\nInference on the model parameters is carried out with an MCMC algorithm. The parameters of the distributions of \\eqn{\\alpha}{\\alpha}, \\eqn{\\beta}{\\beta} and \\eqn{\\lambda}{\\lambda} are given a prior distribution each, to avoid their subjective specifications. The parameters of these hyperpriors need to be fixed and are the following:\n\\itemize{\n\\item{}{\\code{tauA, taub} and \\code{tauL} are the scale factors for the variances of the hyperprior distributions for the mean parameters of \\eqn{\\alpha^{(k)}, \\beta^{(k)}}{\\alpha_k , \\beta_k} and \\eqn{\\lambda_l}{\\lambda_l}. If not specified by the user, the first two parameters are computed as \\eqn{(K-1)\\ K }{( K - 1 ) \\ K }, if \\eqn{K > 1}{K > 1}, otherwise they are set to \\eqn{0.5}{0.5}. The last parameter is calculated as and \\eqn{(L-1)\\ K }{( L - 1 ) \\ K }, if \\eqn{L > 1}{L > 1}, otherwise it is set to \\eqn{0.5}{0.5}.    }\n\\item{}{\\code{muA, mub} and \\code{muL} are the means of the hyperprior distributions for the mean parameters of \\eqn{\\alpha^{(k)}, \\beta^{(k)}}{\\alpha_k , \\beta_k} and \\eqn{\\lambda_l}{\\lambda_l}. If not specified by the user, they are all set to \\eqn{0}{0}. }\n\\item{}{\\code{nuA, nub} and \\code{nuL} are the degrees of freedom of the hyperprior distributions for the variance parameters of \\eqn{\\alpha^{(k)}, \\beta^{(k)}}{\\alpha_k , \\beta_k} and \\eqn{\\lambda_l}{\\lambda_l}. If not specified by the user, they are all set to \\eqn{3}{3}. }\n}\n\n}\n%\\author{Silvia D'Angelo, Michael Fop}\n\n\n\\examples{\n\\dontrun{\n### Example: Vickers data\ndata(vickers)\n\n## 2-dimensional latent space model, with no covariates\n\nmod <- multiNet(vickers, niter = 1000, D = 2,\n                alphaRef = alphaRef( vickers, 2)\n)\n\n## 2-dimensional latent space model, with covariates\n\nmod <- multiNet(vickers, niter = 1000, D = 2,\n                alphaRef = alphaRef( vickers, 2),\n                covariates = sex\n)\n}\n}\n\n\\references{\nD'Angelo, S. and Murphy, T. B. and Alfò, M. (2018). Latent space modeling of multidimensional networks with application to the exchange of votes in the Eurovision\nSong Contest. \\emph{arxiv}\n\n}\n\n\\seealso{\n\\code{\\link{multiNet}}, \\code{\\link{alphaRef}}\n}\n",
    "created" : 1520516390047.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "916165123",
    "id" : "74670C88",
    "lastKnownWriteTime" : 1520516476,
    "last_content_update" : 1520516476743,
    "path" : "C:/Users/Antonio/Downloads/spaceNet/spaceNet/man/spaceNet.Rd",
    "project_path" : "man/spaceNet.Rd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_doc"
}